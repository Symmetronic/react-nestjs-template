The repository is a small monorepo with a NestJS backend and a Vite + React frontend. These notes help an AI code assistant make safe, idiomatic edits.

High-level architecture

- Backend: NestJS app in `backend/`. Entry: `backend/src/main.ts`. Modules live under `backend/src/features/*` (auth, health, user). OpenAPI is generated to `backend/openapi.yaml` by running the server with `ONLY_GENERATE_OPENAPI=true`.
- Frontend: Vite + React in `frontend/`. Entry: `frontend/src/main.tsx`. Routing is powered by `@tanstack/react-router` and the generated `routeTree` in `frontend/routeTree.gen.ts`.
- Tests: Playwright UI tests live under `tests/e2e/` and depend on the running app backend+frontend.

How to run & common commands

- Root commands (run from repository root): see `package.json` scripts. Common flows:
  - Start both in dev: `npm run dev` (runs backend and frontend; frontend waits for backend health endpoint).
  - Build everything: `npm run build`.
  - Run UI tests: `npm test` (runs tests in `tests/`).
- Backend specific (in `backend/package.json`):
  - Dev: `cd backend && npm run dev` (uses `env/development.env`).
  - Generate OpenAPI: `cd backend && npm run generate:openapi` (sets `ONLY_GENERATE_OPENAPI=true` via `env/generate-openapi.env`). OpenAPI yaml is written to `backend/openapi.yaml` and used by frontend's `orval` generator.
- Frontend specific (in `frontend/package.json`):
  - Dev: `cd frontend && npm run dev` (vite).
  - Generate API client: `cd frontend && npm run generate:api` (uses `orval` and `backend/openapi.yaml`).

Project conventions & patterns (follow these exactly)

- Error/result shape: services return a Result type under `backend/src/types/result.type.ts` and helper utils in `backend/src/utils/{success-result.util.ts,error-result.util.ts}`. Prefer returning Result to throwing inside service layers; controllers map errors to HTTP exceptions (see `auth.controller.ts`).
- Minimal business logic: user/password check is done in `AuthService.login` using `UserService.findUserByEmail`. Tokens are created by a fixed helper `createToken` in `auth.service.ts` — if changing auth behavior, update tests and the OpenAPI contract.
- OpenAPI operationId: controller methods are wired so operationId equals method name (`operationIdFactory` in `backend/src/main.ts`) — don't change method names if they must match generated client calls (e.g., `postLogin`).
- Generated code: frontend API clients are generated by `orval` into `frontend/src/api/generated`. Regenerate after changing backend OpenAPI.
- Imports: project uses path alias `@/` across backend and frontend. Respect that when adding files (check tsconfig/paths in each package).

Editing guidance for AI agents

- Small, focused changes only. When modifying an API surface (controllers, DTOs, OpenAPI), also update:
  1. `backend/openapi.yaml` (re-generate via `npm run generate:openapi`) and
  2. frontend API client (`cd frontend && npm run generate:api`).
- Prefer edits in service-layer functions rather than controller HTTP plumbing. Controllers perform mapping between Result and HTTP errors — keep that pattern.
- When adding routes, update `AppModule` imports (`backend/src/app.module.ts`) and add feature modules under `backend/src/features/`.
- Tests: update `tests/e2e/*` when behavior or UI selectors change. Playwright fixtures are opinionated; search `tests/e2e/fixtures.ts` for helpers.

Where to look for examples

- Auth flow: `backend/src/features/auth/*` + frontend UI: `frontend/src/features/auth/components/*` and tests `tests/e2e/tests/login.spec.ts`.
- Health endpoint: implementation in `backend/src/features/health/health.controller.ts` and used by root `npm run dev` wait-on logic.
- OpenAPI usage: `backend/src/main.ts` (generation) and `frontend/orval.config.ts` (client generation).

Quality gates

- Run lint and format scripts before PRs: root `npm run lint` and `npm run format:check`.
- Run tests: `npm test` (e2e). If changing backend types or DTOs, regenerate OpenAPI and the frontend client and re-run tests.

If something's unclear

- Ask: which side to change (backend vs frontend), whether the OpenAPI contract is allowed to change, and whether tests should be updated.

Quick checklist for PR edits

1. Make code change.
2. Run `npm run format` and `npm run lint`.
3. If API changed: `cd backend && npm run generate:openapi` then `cd frontend && npm run generate:api`.
4. Run `npm test` and fix failing tests.

If you want me to expand any section or to include example commit messages and PR templates, tell me which area to focus on.
